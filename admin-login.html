<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๊ด๋ฆฌ์ ๋ก๊ทธ์ธ - ๋๋ฌผ ์ด์ฑ ๋น๊ณ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="header-icon">
                <div class="icon-wrapper gradient-purple">
                    <span style="font-size: 3rem;">๐</span>
                </div>
            </div>
            <h2 class="subtitle">๊ด๋ฆฌ์ ๋ก๊ทธ์ธ</h2>
            <p style="text-align: center; color: #cbd5e1; font-size: 0.875rem; margin-bottom: 2rem;">
                ๊ด๋ฆฌ์ ๊ณ์์ผ๋ก ๋ก๊ทธ์ธํ์ธ์
            </p>

            <div class="input-group">
                <label class="input-label">
                    <span>๐ค</span>
                    <span>์์ด๋</span>
                </label>
                <input 
                    type="text" 
                    id="adminId" 
                    class="input-field" 
                    placeholder="๊ด๋ฆฌ์ ์์ด๋"
                >
            </div>

            <div class="input-group">
                <label class="input-label">
                    <span>๐</span>
                    <span>๋น๋ฐ๋ฒํธ</span>
                </label>
                <input 
                    type="password" 
                    id="adminPassword" 
                    class="input-field" 
                    placeholder="๋น๋ฐ๋ฒํธ"
                >
            </div>

            <button class="btn btn-primary" onclick="adminLogin()">
                <span>๐</span>
                <span>๋ก๊ทธ์ธ</span>
            </button>

            <button class="btn btn-ghost" onclick="location.href='index.html'">
                <span>๐</span>
                <span>๋ฉ์ธ์ผ๋ก ๋์๊ฐ๊ธฐ</span>
            </button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCCuAOnkEmfFEE57D3bgWLU7xR2f0i2psI",
            authDomain: "animal-bingo-90774.firebaseapp.com",
            databaseURL: "https://animal-bingo-90774-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "animal-bingo-90774",
            storageBucket: "animal-bingo-90774.firebasestorage.app",
            messagingSenderId: "547100283990",
            appId: "1:547100283990:web:d1206d278a9f46eaf2d7f7",
            measurementId: "G-E8WLHPJ24E"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // ๊ด๋ฆฌ์ ๋ก๊ทธ์ธ
        function adminLogin() {
            const adminId = document.getElementById('adminId').value.trim();
            const adminPassword = document.getElementById('adminPassword').value.trim();

            console.log('๊ด๋ฆฌ์ ๋ก๊ทธ์ธ ์๋:', adminId);

            if (!adminId || !adminPassword) {
                alert('์์ด๋์ ๋น๋ฐ๋ฒํธ๋ฅผ ์๋ฅํด์ฃผ์ธ์.');
                return;
            }

            // Firebase์์ ํด๋น ์์ ํ์ธ
            database.ref('users').orderByChild('username').equalTo(adminId).once('value')
                .then((snapshot) => {
                    console.log('์ฌ์ฉ์ ์กฐํ ๊ฒฐ๊ณผ:', snapshot.exists());
                    console.log('๋ฐ์ดํฐ:', snapshot.val());

                    if (!snapshot.exists()) {
                        alert('์กด์ฌํ์ง ์๋ ๊ณ์์๋๋ค.');
                        return;
                    }

                    const userId = Object.keys(snapshot.val())[0];
                    const user = snapshot.val()[userId];

                    console.log('์ฌ์ฉ์ ์๋ณด:', user);

                    if (user.password !== adminPassword) {
                        alert('๋น๋ฐ๋ฒํธ๊ฐ ์ผ์นํ์ง ์์ต๋๋ค.');
                        return;
                    }

                    // ๊ด๋ฆฌ์ ๊ถํ ํ์ธ
                    console.log('๊ด๋ฆฌ์ ๊ถํ:', user.isAdmin);
                    if (!user.isAdmin) {
                        alert('๊ด๋ฆฌ์ ๊ถํ์ด ์์ต๋๋ค.');
                        return;
                    }

                    // ๋ก๊ทธ์ธ ์ฑ๊ณต
                    console.log('๊ด๋ฆฌ์ ๋ก๊ทธ์ธ ์ฑ๊ณต');
                    sessionStorage.setItem('adminLoggedIn', 'true');
                    sessionStorage.setItem('adminId', userId);
                    location.href = 'admin-dashboard.html';
                })
                .catch((error) => {
                    console.error('๋ก๊ทธ์ธ ์ค๋ฅ:', error);
                    alert('๋ก๊ทธ์ธ ์ค ์ค๋ฅ๊ฐ ๋ฐ์ํ์ต๋๋ค: ' + error.message);
                });
        }

        // Enter ํค ์ด๋ฒคํธ
        document.getElementById('adminId').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                document.getElementById('adminPassword').focus();
            }
        });

        document.getElementById('adminPassword').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                adminLogin();
            }
        });
    </script>
</body>
</html>
